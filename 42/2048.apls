#!/usr/local/bin/dyalogscript
⎕IO←0 ⋄ g←4 4↑~∘0⍤1
c←>/∘⌽¨(,\0∘≠×2=/0,⊢)
r←{⍵+2 4[0=?10]×4 4⍴0=⍋⍒(1+?⍨16)×0=,⍵}
s←{⍉∘⌽⍣⍵ g×∘(1∘⌽+~)∘c⍨g ⌽∘⍉⍣⍵ ⊢⍺}
l←∧/∘,{~⍵[1;1]∊⍵×3 3⍴0 1}⌺3 3⍤⊣
⎕←'LW'[2048≤⌈/,⎕←{
 ⎕ ⎕←⍵ 'enter key (wasd): '
 r⍣(A≢⍵)⊢A←⍵s'asdw'⍳⎕C⊃⍞
}⍣l r 4 4⍴0]